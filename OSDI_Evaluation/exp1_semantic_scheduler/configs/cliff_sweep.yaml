# Cliff Experiment Configuration
# Tests both vLLM and Djinn at increasing N to show where vLLM crashes
# and Djinn continues gracefully

workload:
  # Starting at N=10, will be overridden by cliff_experiment.py per run
  total_agents: 80
  
  # Poisson arrival process
  # Agents arrive staggered, not all at once
  # This prevents "thundering herd" and matches real workload
  arrival_rate: 0.2  # agents per second (1 every 5 seconds)
  
  # Think time (tool execution, I/O wait)
  # Long enough for semantic scheduler to perform swaps
  think_time_min: 10.0
  think_time_max: 20.0
  
  # Model inference parameters
  context_length: 1024  # Input tokens (matches Djinn/vLLM workload)
  new_tokens: 50       # Output tokens to generate
  iterations: 1        # One pass per agent
  
  # Memory pressure
  # With 80 agents Ã— 2GB KV cache = 160GB total demand
  # But GPU only has 80GB
  # Proves memory virtualization is essential

expected_results:
  # At each N, we expect:
  # - vLLM to work fine until N~48, then crash
  # - Djinn to scale smoothly to N=80+
  
  vllm_crash_point: 48       # Where vLLM OOMs (expected)
  djinn_max_agents: 80       # Where Djinn succeeds
  
  # Key insight: Djinn achieves 1.67x density improvement
  # (80 agents vs vLLM's 48) through semantic scheduling
  
experiment_phases:
  # Phase 1: Quick smoke test
  # N=10 agents, quick validation
  smoke_test:
    total_agents: 10
    arrival_rate: 0.5
    think_time_min: 2.0
    think_time_max: 5.0
  
  # Phase 2: Find vLLM cliff
  # Test N = [10, 20, 30, 40, 45, 48, 50, 55, 60]
  # Stop when vLLM OOMs
  vllm_cliff:
    agents: [10, 20, 30, 40, 45, 48, 50, 55, 60]
    timeout_s: 300
    iterations: 1
  
  # Phase 3: Djinn scaling
  # Test N = [10, 20, 30, 40, 50, 60, 70, 80]
  # Should scale smoothly past vLLM's crash point
  djinn_scaling:
    agents: [10, 20, 30, 40, 50, 60, 70, 80]
    timeout_s: 600
    iterations: 2  # For statistical robustness

validation_thresholds:
  # Pass/fail criteria for OSDI submission
  
  # vLLM must crash before N=60 (prove the cliff exists)
  vllm_crash_before_n: 60
  
  # Djinn must handle N=80 (1.67x vLLM)
  djinn_handles_n: 80
  
  # Djinn P99 latency must be reasonable
  # With 80 agents and GPU contention, expect 15-30s
  djinn_p99_latency_ms_max: 30000
  
  # Both must maintain 100% success rate at their limits
  success_rate_min: 0.95
