# L4 GPU Quick Smoke Test Configuration
# Fast validation of ring buffer on smaller model

experiment:
  name: "virtual_memory_smoke_test_l4"
  description: "Quick validation of ring buffer implementation on L4"
  
  ring_buffer:
    enabled: true
    capacity_gb: 8  # Smaller for faster allocation
    prefetch_workers: 1
  
  model:
    # Smaller model for quick test
    model_id: "EleutherAI/gpt-j-6B"
    dtype: "float32"
    device: "cuda:0"
  
  inference:
    batch_size: 1
    max_seq_len: 512
    prompt_length: 128
    generation_length: 20
    temperature: 0.7
    top_p: 0.9
  
  measurement:
    runs: 2  # Just 2 runs for smoke test
    warmup_runs: 1
    gc_between_runs: true
    disable_gc_during_run: true

baselines:
  ring_buffer_async_prefetch:
    enabled: true
    use_async_prefetch: true

tuning:
  pin_weights: true
  pin_memory_gb: 4
  cuda_graphs: false
  torch_compile: false
  cudnn_benchmark: true
  prefetch_stream_priority: -1
  compute_stream_priority: 0

environment:
  os_swap: "disabled"
  ulimit_memlock: "unlimited"
  numa_bind: false
  gpu_index: 0
  max_gpu_memory_gb: 24  # L4
  os_reserve_gb: 1
  safety_margin_gb: 1

logging:
  level: "DEBUG"
  verbose: true
  log_file: "/tmp/djinn_virt_mem_smoke_l4.log"

output:
  results_dir: "OSDI_Evaluation/exp2_virtual_memory/results"
  metrics:
    - "effective_bandwidth_gbps"
    - "latency_ms"
    - "peak_vram_mb"
    - "logit_norm_diff"

